{"ast":null,"code":"var _jsxFileName = \"/Users/andrewklayver/Desktop/login-vittude/src/contexts/auth.js\",\n    _s = $RefreshSig$();\n\nimport { createContext, useEffect, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({});\nexport const AuthProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState();\n  useEffect(() => {\n    const userToken = localStorage.getItem(\"user_token\");\n    const usersStorage = localStorage.getItem(\"users_bd\");\n\n    if (userToken && usersStorage) {\n      var _JSON$parse;\n\n      const hasUser = (_JSON$parse = JSON.parse(usersStorage)) === null || _JSON$parse === void 0 ? void 0 : _JSON$parse.filter(user => user.email === JSON.parse(userToken).email);\n      if (hasUser) setUser(hasUser[0]);\n    }\n  }, []);\n\n  const signin = (email, password) => {\n    const usersStorage = JSON.parse(localStorage.getItem(\"users_bd\"));\n    const hasUser = usersStorage === null || usersStorage === void 0 ? void 0 : usersStorage.filter(user => user.email === email);\n\n    if (hasUser !== null && hasUser !== void 0 && hasUser.length) {\n      if (hasUser[0].email === email && hasUser[0].password === password) {\n        const token = Math.random().toString(36).substring(2);\n        localStorage.setItem(\"user_token\", JSON.stringify({\n          email,\n          token\n        }));\n        setUser({\n          email,\n          password\n        });\n        return;\n      } else {\n        return \"E-mail ou senha incorretos\";\n      }\n    } else {\n      return \"Usuário não cadastrado\";\n    }\n  };\n\n  const signup = (email, password) => {\n    const usersStorage = JSON.parse(localStorage.getItem(\"users_bd\"));\n    const hasUser = usersStorage === null || usersStorage === void 0 ? void 0 : usersStorage.filter(user => user.email === email);\n\n    if (hasUser !== null && hasUser !== void 0 && hasUser.length) {\n      return \"Já tem uma conta com esse E-mail\";\n    }\n\n    let newUser;\n\n    if (usersStorage) {\n      newUser = [...usersStorage, {\n        email,\n        password\n      }];\n    } else {\n      newUser = [{\n        email,\n        password\n      }];\n    }\n\n    localStorage.setItem(\"users_bd\", JSON.stringify(newUser));\n    return;\n  };\n\n  const signout = () => {\n    setUser(null);\n    localStorage.removeItem(\"user_token\");\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      signed: !!user,\n      signin,\n      signup,\n      signout\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AuthProvider, \"hT6C72rcbfRUedrDq+TPaFfRI/M=\");\n\n_c = AuthProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useEffect","useState","AuthContext","AuthProvider","children","user","setUser","userToken","localStorage","getItem","usersStorage","hasUser","JSON","parse","filter","email","signin","password","length","token","Math","random","toString","substring","setItem","stringify","signup","newUser","signout","removeItem","signed"],"sources":["/Users/andrewklayver/Desktop/login-vittude/src/contexts/auth.js"],"sourcesContent":["import { createContext, useEffect, useState } from \"react\";\n\nexport const AuthContext = createContext({});\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState();\n\n  useEffect(() => {\n    const userToken = localStorage.getItem(\"user_token\");\n    const usersStorage = localStorage.getItem(\"users_bd\");\n\n    if (userToken && usersStorage) {\n      const hasUser = JSON.parse(usersStorage)?.filter(\n        (user) => user.email === JSON.parse(userToken).email\n      );\n\n      if (hasUser) setUser(hasUser[0]);\n    }\n  }, []);\n\n  const signin = (email, password) => {\n    const usersStorage = JSON.parse(localStorage.getItem(\"users_bd\"));\n\n    const hasUser = usersStorage?.filter((user) => user.email === email);\n\n    if (hasUser?.length) {\n      if (hasUser[0].email === email && hasUser[0].password === password) {\n        const token = Math.random().toString(36).substring(2);\n        localStorage.setItem(\"user_token\", JSON.stringify({ email, token }));\n        setUser({ email, password });\n        return;\n      } else {\n        return \"E-mail ou senha incorretos\";\n      }\n    } else {\n      return \"Usuário não cadastrado\";\n    }\n  };\n\n  const signup = (email, password) => {\n    const usersStorage = JSON.parse(localStorage.getItem(\"users_bd\"));\n\n    const hasUser = usersStorage?.filter((user) => user.email === email);\n\n    if (hasUser?.length) {\n      return \"Já tem uma conta com esse E-mail\";\n    }\n\n    let newUser;\n\n    if (usersStorage) {\n      newUser = [...usersStorage, { email, password }];\n    } else {\n      newUser = [{ email, password }];\n    }\n\n    localStorage.setItem(\"users_bd\", JSON.stringify(newUser));\n\n    return;\n  };\n\n  const signout = () => {\n    setUser(null);\n    localStorage.removeItem(\"user_token\");\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{ user, signed: !!user, signin, signup, signout }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}